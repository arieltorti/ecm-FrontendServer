(function(t){function e(e){for(var n,o,s=e[0],l=e[1],u=e[2],m=0,d=[];m<s.length;m++)o=s[m],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&d.push(i[o][0]),i[o]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);c&&c(e);while(d.length)d.shift()();return r.push.apply(r,u||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],n=!0,s=1;s<a.length;s++){var l=a[s];0!==i[l]&&(n=!1)}n&&(r.splice(e--,1),t=o(o.s=a[0]))}return t}var n={},i={app:0},r=[];function o(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=n,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(a,n,function(e){return t[e]}.bind(null,n));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="https://cdn.jsdelivr.net/gh/maks500/ecm-FrontendServer@release/static/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var c=l;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"0026":function(t,e,a){},"034f":function(t,e,a){"use strict";var n=a("85ec"),i=a.n(n);i.a},1:function(t,e){},"11c7":function(t,e,a){"use strict";var n=a("bc62"),i=a.n(n);i.a},"1aa9":function(t,e,a){"use strict";var n=a("ffb2"),i=a.n(n);i.a},"2f84":function(t,e,a){},"362d":function(t,e,a){"use strict";var n=a("45fc"),i=a.n(n);i.a},"45fc":function(t,e,a){},"51ab":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("fieldset",[a("Calculator")],1),a("fieldset",[a("legend",[t._v("Choose a model:")]),a("label",{attrs:{for:"model"}},[t._v("Model: ")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.modelSelected,expression:"modelSelected"}],staticStyle:{display:"inline-block"},attrs:{name:"model",id:"model"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.modelSelected=e.target.multiple?a:a[0]}}},t._l(t.modelList,(function(e,n){return a("option",{key:n,domProps:{value:n}},[t._v(t._s(e.name))])})),0)]),t.modelSelected&&t.currentModel?a("fieldset",[a("CurrentModel",{attrs:{currentModel:t.currentModel}})],1):t._e(),t.modelSelected&&t.currentModel?a("Editor",{attrs:{model:t.currentModel,simulation:t.simulation}}):t._e(),t.modelSelected?a("fieldset",[a("legend",[t._v("Simulation")]),a("button",{attrs:{disabled:t.simulationState===t.SIM_STATE.INPROGRESS},on:{click:t.simulate}},[t._v(" Simulate ")]),t.currentModel?a("Simulation",{attrs:{sim:t.currentSimulation,"sim-cancel":t.simCancel,"sim-state":t.simulationState},on:{"sim-start":t.handleSimStart,"sim-error":t.handleSimError,"sim-done":t.handleSimDone,"sim-cancel":t.handleSimCancel}}):t._e()],1):t._e(),a("Authors"),a("hr"),a("Instructions"),t._m(0)],1)},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"license"},[t._v(" This software is licensed under GPLv3 and can be obtained at "),a("a",{attrs:{href:"https://github.com/maks500/ecm-FrontendServer"}},[t._v("ecm-FrontendServer")])])}],o=(a("4160"),a("b0c0"),a("b64b"),a("d3b7"),a("159b"),a("b85c")),s=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},l=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("span",{staticClass:"category"},[t._v("Authors:")]),a("p",{staticClass:"names"},[t._v(" Nicolás Morando (*), Mauricio Sanfilippo, Daniel Gutson, Roberto Daniel Rabinovich (*), María de los Ángeles Pando (*). ")]),a("span",{staticClass:"category"},[t._v("Programmers:")]),a("p",{staticClass:"names"},[t._v(" Francisco Herrero, Matías Iturburu, Ariel Torti. ")]),a("span",{staticClass:"category"},[t._v("Acknowledgments:")]),a("p",{staticClass:"names"},[a("a",{attrs:{href:"https://cs.famaf.unc.edu.ar/~nicolasw/"}},[t._v("Nicolás Wolovick (**)")])]),a("div",{staticClass:"references"},[a("span",[a("a",{attrs:{href:"http://www.inbirs.org.ar/"}},[t._v("* Instituto de Investigaciones Biomédicas en Retrovirus y SIDA")])]),a("span",[a("a",{attrs:{href:"https://www.famaf.unc.edu.ar/"}},[t._v("** Facultad de Matemática, Astronomía, Física y Computación")])])])])}],u={},c=u,m=(a("362d"),a("2877")),d=Object(m["a"])(c,s,l,!1,null,"4463a39d",null),p=d.exports,v=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},f=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("h2",{staticClass:"text-center"},[t._v("Instructions")]),a("section",[a("h3",[t._v("Model Simulation")]),a("ol",[a("li",[t._v("Click on the "),a("b",[t._v("Model")]),t._v(" selection box")]),a("li",[t._v("Choose the desired model (e.g. SEIR 5G)")]),a("li",[t._v(" Model equations will be shown in the "),a("b",[t._v("Model Details")]),t._v(" section below ")]),a("li",[t._v(" On the "),a("i",[t._v("Simulation Parameters")]),t._v(" section: "),a("ul",[a("li",[a("div",{staticClass:"li-container"},[a("h4",[t._v("General")]),a("span",[t._v("Enter the simulation time in days")]),a("span",[t._v("Enter the number of steps per day")])])]),a("li",[a("div",{staticClass:"li-container"},[a("h4",[t._v("Initial conditions")]),a("span",[t._v("For each subpopulation (G1 to G5) enter the number of susceptibles (S), Exposed (E), Infectious (I) and Resistant (R)")])])]),a("li",[a("div",{staticClass:"li-container"},[a("h4",[t._v("Params")]),a("span",[t._v("Enter the values for p, gama (γ) and sigma (σ)")]),a("span",[t._v("Range usage: the "),a("i",[t._v("range")]),t._v(" button can be clicked and both limits can be defined as desired")]),a("span",[t._v("Enter the values of C (number of contacts per unit of time) and N (number of individual on each subpopulation) for each subpopulation (G1 to G5)")])])])])]),a("li",[a("div",{staticClass:"li-container"},[a("span",[t._v("In the "),a("i",[t._v("Simulation")]),t._v(" section click the "),a("b",[t._v("Simulate")]),t._v(" button")]),a("span",[t._v("Graphs that correspond to S, E, I, R totals will appear")])])]),a("li",[t._v(" To visualize a specific subpopulation click on the corresponding checkbox ")]),a("li",[a("div",{staticClass:"li-container"},[a("span",[t._v("Hovering the mouse on each line of the graph will show the values of the selected spot (the graph can be zoomed in and out)")]),a("span",[t._v("If a range value was used an slider will be shown below the graph")])])]),a("li",[t._v(" Moving the slider dot will show the corresponding graph on real time ")]),a("li",[t._v(" In order to obtain the generated S, E, I, R values during the whole simulation the "),a("b",[t._v("Download CSV")]),t._v(" can be clicked to download a comma separated value file containing their values ")]),a("li",[t._v(' To visualize the downloaded file, open a new Excel File, go to the "Data" tab, inside "Get external data" select "From text", locate the folder in which the .csv file is stored and select it, the text import assitant will be opened. On step 1 click "Next", on step 2 check "Comma" on "Separators", on step 3 go to "Advanced" and enter a dot (".") as the decimal separator and a comma (",") as the thousands separator, then click "Accept" and "End" ')])])]),a("section",[a("h3",[t._v("R estimation")]),a("ol",[a("li",[t._v('Click on the "Ro calculator" tab')]),a("li",[t._v("Enter the values for p and gamma (γ)")]),a("li",[t._v(' On the text box labeled "S" enter the number of susceptibles at a moment of time when the value of R(t)/Re will be calculated ')]),a("li",[t._v(" For each subpopulation enter the number of individuals and the number of daily contacts for each type of contact on the corresponding text boxes ")]),a("li",[t._v(" On the right of each line the number of contacts for each subpopulation will be shown ")]),a("li",[t._v(" On the "),a("i",[t._v("Results")]),t._v(" section the values for population's N, population contacts mean, R0 and R(t) will be shown ")])])])])}],h={},g=h,b=(a("ac8d"),Object(m["a"])(g,v,f,!1,null,"8dda5226",null)),_=b.exports,y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("fieldset",[a("legend",[t._v("Simulation parameters")]),a("details",[a("summary",[t._v("General")]),a("label",{attrs:{for:"days"}},[t._v("Days:")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.simulation.days,expression:"simulation.days",modifiers:{number:!0}}],attrs:{name:"days",type:"number"},domProps:{value:t.simulation.days},on:{input:function(e){e.target.composing||t.$set(t.simulation,"days",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),a("label",{attrs:{for:"step"}},[t._v("Step:")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.simulation.step,expression:"simulation.step",modifiers:{number:!0}}],attrs:{name:"step",type:"number"},domProps:{value:t.simulation.step},on:{input:function(e){e.target.composing||t.$set(t.simulation,"step",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),a("details",[a("summary",[t._v("Initial conditions")]),a("ConditionGroup",{attrs:{group:t.model.ungrouped,simulation:t.simulation}}),t._l(t.model.groups,(function(e){return a("ConditionGroup",{key:e.name,attrs:{group:e,simulation:t.simulation}})}))],2),a("details",[a("summary",[t._v("Params")]),a("ParamGroup",{attrs:{group:t.model.ungrouped,simulation:t.simulation}}),t._l(t.model.groups,(function(e){return a("ParamGroup",{key:e.name,attrs:{group:e,simulation:t.simulation}})}))],2)])},S=[],x=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.group.params.length>0?a("div",{staticClass:"group"},[a("span",[t._v(t._s(t.group.name))]),t._l(t.group.params,(function(e){return a("Param",{key:e.name,attrs:{param:e,simulation:t.simulation}})}))],2):t._e()},w=[],C=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("strong",[a("span",{directives:[{name:"katex",rawName:"v-katex",value:t.param.nameLatex,expression:"param.nameLatex"}]}),t._v(": ")]),t.param.iterable?a("div",{staticClass:"label-input"},[a("label",{attrs:{for:"param"}},[t._v("with range:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.simulation.iterate.key,expression:"simulation.iterate.key"}],attrs:{type:"radio",id:"param"},domProps:{value:t.param.name,checked:t._q(t.simulation.iterate.key,t.param.name)},on:{click:function(e){return t.paramUncheck(t.param.name)},change:function(e){return t.$set(t.simulation.iterate,"key",t.param.name)}}})]):t._e(),t.simulation.iterate.key==t.param.name?a("div",[a("label",{attrs:{for:t.param+"Start"}},[t._v("Start:")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.simulation.iterate.start,expression:"simulation.iterate.start",modifiers:{number:!0}}],attrs:{id:t.param+"Start",type:"number"},domProps:{value:t.simulation.iterate.start},on:{input:function(e){e.target.composing||t.$set(t.simulation.iterate,"start",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),a("label",{attrs:{for:t.param+"End"}},[t._v("End:")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.simulation.iterate.end,expression:"simulation.iterate.end",modifiers:{number:!0}}],attrs:{id:t.param+"End",type:"number"},domProps:{value:t.simulation.iterate.end},on:{input:function(e){e.target.composing||t.$set(t.simulation.iterate,"end",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),a("label",{attrs:{for:t.param+"Intervals"}},[t._v("Intervals:")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.simulation.iterate.intervals,expression:"simulation.iterate.intervals",modifiers:{number:!0}}],attrs:{id:t.param+"Intervals",type:"number"},domProps:{value:t.simulation.iterate.intervals},on:{input:function(e){e.target.composing||t.$set(t.simulation.iterate,"intervals",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]):a("div",[a("label",{attrs:{for:t.param}},[t._v("Value:")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.simulation.params[t.param.name],expression:"simulation.params[param.name]",modifiers:{number:!0}}],attrs:{type:"number",id:t.param},domProps:{value:t.simulation.params[t.param.name]},on:{input:function(e){e.target.composing||t.$set(t.simulation.params,t.param.name,t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])])},O=[],E={props:["param","simulation"],methods:{paramUncheck:function(t){this.simulation.iterate.key==t&&(this.simulation.iterate.key=null)}}},R=E,k=(a("7cbd"),Object(m["a"])(R,C,O,!1,null,"fa7aee38",null)),I=k.exports,j={components:{Param:I},props:["group","simulation"]},M=j,D=(a("9391"),Object(m["a"])(M,x,w,!1,null,"38544a90",null)),N=D.exports,$=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.group.compartments.length>0?a("div",{staticClass:"group"},[a("span",[t._v(t._s(t.group.name))]),t._l(t.group.compartments,(function(e){return a("Condition",{key:e.name,attrs:{comp:e,simulation:t.simulation}})}))],2):t._e()},P=[],G=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("label",{attrs:{for:t.comp}},[a("span",{directives:[{name:"katex",rawName:"v-katex",value:t.comp.initLatex,expression:"comp.initLatex"}]}),t._v(": ")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.simulation.initial_conditions[t.comp.name],expression:"simulation.initial_conditions[comp.name]",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:t.simulation.initial_conditions[t.comp.name]},on:{input:function(e){e.target.composing||t.$set(t.simulation.initial_conditions,t.comp.name,t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])},A=[],T={props:["comp","simulation"]},L=T,V=Object(m["a"])(L,G,A,!1,null,null,null),F=V.exports,U={components:{Condition:F},props:["group","simulation"]},H=U,B=(a("11c7"),Object(m["a"])(H,$,P,!1,null,"16787ea0",null)),J=B.exports,q={props:["model","simulation"],components:{ParamGroup:N,ConditionGroup:J}},z=q,Y=Object(m["a"])(z,y,S,!1,null,null,null),W=Y.exports,X=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{position:"relative"}},[t.simState===t.SIM_STATE.INPROGRESS?a("div",{staticClass:"progress"},[t._v(" Simulating ")]):t._e(),t.simState===t.SIM_STATE.FAILED?a("div",{staticClass:"errorMsg"},[t._v(" Error: "+t._s(t.errMsg)+" ")]):t._e(),a("div",{class:{hidden:t.isNotDone}},[a("button",{attrs:{id:"downloadCSV"},on:{click:t.downloadCSV}},[t._v("Download CSV")]),a("GroupControls",{attrs:{model:t.sim.model},on:{changeGroupVisibility:t.changeGroupVisibility}}),a("div",{attrs:{id:"imageDiv"}},[t._m(0),a("div",{directives:[{name:"katex",rawName:"v-katex:display",value:t.simulationInfo,expression:"simulationInfo",arg:"display"}],attrs:{id:"simulationInfo"}})])],1),t.simState===t.SIM_STATE.DONE&&t.isMultiple?a("div",{staticClass:"data-html2canvas-ignore",attrs:{id:"plotAnimDiv"}},[a("button",{on:{click:t.handleAnimClick}},[t._v(t._s(t.playing?"| |":"▶"))])]):t._e()])},K=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"plotlyInstance",attrs:{id:"plotDiv"}})}],Q=(a("99af"),a("c740"),a("c975"),a("a15b"),a("d81d"),a("fb6a"),a("3ca3"),a("ddb0"),a("2b3d"),a("5530")),Z=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"group-container"},t._l(this.model.groups,(function(e,n){return a("div",{key:e.name,staticClass:"group"},[a("label",{attrs:{for:e.name}},[t._v(t._s(e.name)+" ")]),a("input",{attrs:{type:"checkbox",id:e.name},domProps:{checked:e.visible},on:{click:function(e){return t.$emit("changeGroupVisibility",n,e.target.checked)}}})])})),0)},tt=[],et={props:["model"]},at=et,nt=(a("ea97"),Object(m["a"])(at,Z,tt,!1,null,"7c22d1ee",null)),it=nt.exports,rt={DONE:0,INPROGRESS:1,CANCELED:2,FAILED:3,NONE:4},ot="simulationModel",st={yaxis:{fixedrange:!0},xaxis:{title:"Days"}},lt=(a("7db0"),a("4fad"),a("d80f"),a("3835")),ut=a("8785"),ct=a("2909"),mt=a("030a");function dt(){var t=Object(ut["a"])(["end{array} end{array}"],["\\end{array} \\end{array}"]);return dt=function(){return t},t}function pt(){var t=Object(ut["a"])([""," & "," \\"],[""," & "," \\\\"]);return pt=function(){return t},t}function vt(){var t=Object(ut["a"])(["\begin{array}{cc} \\"],["\\begin{array}{cc} \\\\"]);return vt=function(){return t},t}function ft(){var t=Object(ut["a"])(["end{array}\n  &"],["\\end{array}\n  &"]);return ft=function(){return t},t}function ht(){var t=Object(ut["a"])([""," & "," \\"],[""," & "," \\\\"]);return ht=function(){return t},t}function gt(){var t=Object(ut["a"])(["\begin{array}{cc}"],["\\begin{array}{cc}"]);return gt=function(){return t},t}function bt(){var t=Object(ut["a"])(["\text{Model: "," - Days: ","} \\\n\begin{array}{c}"],["\\text{Model: "," - Days: ","} \\\\\n\\begin{array}{c}"]);return bt=function(){return t},t}function _t(t){if(null!=t.layout.sliders&&t.layout.sliders.length){var e=t.layout.sliders[0],a=e.active||0;return e.steps[a].label}return null}function yt(t,e){function a(t){var e=r.find((function(e){return e.name===t}));return null==e?null:"".concat(e.nameLatex)}var n=t.model,i=t.simulation,r=[].concat(Object(ct["a"])(n.compartments),Object(ct["a"])(n.expressions),Object(ct["a"])(n.observables),Object(ct["a"])(n.params)),o=Object.assign({},i.params);i.iterate&&i.iterate.key&&(o[i.iterate.key]=_t(e));var s=String.raw(bt(),n.name,i.days);s+=String.raw(gt());for(var l=0,u=Object.entries(o||{});l<u.length;l++){var c=Object(lt["a"])(u[l],2),m=c[0],d=c[1],p=a(m);null!=p&&(s+=String.raw(ht(),p,d))}s+=String.raw(ft()),s+=String.raw(vt());for(var v=0,f=Object.entries(i.initial_conditions||{});v<f.length;v++){var h=Object(lt["a"])(f[v],2),g=h[0],b=h[1],_=a(g);null!=_&&(s+=String.raw(pt(),_,b))}return s+=String.raw(dt()),s}function St(t){return{name:"toImage",title:"Download plot as a png",icon:mt["Icons"].camera,click:t}}var xt=a("c0e9"),wt=a.n(xt);a("a9e3"),a("35b3");function Ct(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7;return Math.round((t+Number.EPSILON)*Math.pow(10,e))/Math.pow(10,e)}var Ot={components:{GroupControls:it},props:["sim","simCancel","simState"],data:function(){return{SIM_STATE:rt,graphHistoricData:[],stats:{totalSteps:null,currentStep:null},errMsg:"",abortSignal:null,playing:!1,simulationInfo:""}},mounted:function(){this.plotConfig=It(this.saveToImage)},computed:{isMultiple:function(){return this.sim&&null!=this.sim.simulation.iterate.key},isNotDone:function(){return this.simState!==rt.DONE}},watch:{sim:function(t){null!=t&&this.simulate()},simCancel:function(t){t&&(this.abortSignal.abort(),this.$emit("sim-cancel"))}},methods:{downloadCSV:function(){kt(this.graphHistoricData,this.isMultiple)},handleError:function(t){var e=this;t.ABORT_ERR&&t.code===t.ABORT_ERR?this.$emit("sim-cancel"):(t.json().then((function(t){e.errMsg=t.error})),this.$emit("sim-error"))},stop:function(){},saveToImage:function(){var t=this;this.simulationInfo=yt(this.sim,this.$refs.plotlyInstance);var e=document.getElementById("imageDiv"),a=document.getElementById("simulationInfo");this.$nextTick((function(){wt()(e,{scrollX:-window.scrollX,scrollY:-window.scrollY,height:e.offsetHeight+a.offsetHeight,onclone:function(t){var e=t.getElementById("simulationInfo");e.style.position="initial",e.style.display="block";var a=t.getElementsByClassName("slider-container");if(0!==a.length){var n=a[0].getBoundingClientRect().height;a[0].style.display="none",e.style.marginTop="-".concat(n,"px")}}}).then((function(e){var a=e.toDataURL("image/png",1);t.simulationInfo="",Rt(a,"png")}))}))},_play:function(){var t=this;mt["animate"]("plotDiv",null,{mode:"immediate",fromcurrent:!0,transition:{duration:300},frame:{duration:500,redraw:!1}}).then((function(){return t.playing=!1}))},_pause:function(){mt["animate"]("plotDiv",[null],{mode:"immediate",fromcurrent:!0,transition:{duration:0},frame:{duration:0,redraw:!1}})},changeGroupVisibility:function(t,e){var a=this.sim.model.groups[t];null!=a&&(a.visible=e),this.updateGraphLayout()},removeHiddenGroups:function(t){var e=[];this.sim.model.groups.map((function(t){if(!t.visible){var a,n=Object(o["a"])(t.compartments);try{for(n.s();!(a=n.n()).done;){var i=a.value;e.push(i.name)}}catch(u){n.e(u)}finally{n.f()}var r,s=Object(o["a"])(t.params);try{for(s.s();!(r=s.n()).done;){var l=r.value;e.push(l.name)}}catch(u){s.e(u)}finally{s.f()}}}));for(var a=[],n=0;n<t.length;n++){a.push([]);var i,r=Object(o["a"])(t[n]);try{for(r.s();!(i=r.n()).done;){var s=i.value;-1==e.indexOf(s._originalName)&&a[n].push(s)}}catch(l){r.e(l)}finally{r.f()}}return a},handleAnimClick:function(){this.playing?this._pause():this._play(),this.playing=!this.playing},simulate:function(){var t=this;if(null!=this.sim){this.$emit("sim-start"),this.graphHistoricData=[],this.simulationInfo="";var e=JSON.parse(JSON.stringify(this.sim.simulation));if(this.isMultiple){if(0===this.sim.simulation.iterate.intervals)return}else delete e.iterate;this._simulate(e,this.sim.model.id).then((function(){return t.dataFetchingDone()})).catch((function(e){return t.handleError(e)}))}},_simulate:function(t,e){var a=this,n=new AbortController,i=n.signal;this.abortSignal=n;var r=fetch("/simulate/".concat(e),{headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},method:"POST",body:JSON.stringify(t),signal:i});return r.then((function(t){if(t.status>=400&&t.status<600)throw t;return t.json()})).then((function(t){if("multiple"===t.type)t.frames.forEach((function(e,n){var i=a.makeGraphData(e);i._iterVal=Ct(t.param.values[n],2),a.graphHistoricData.push(i)}));else{var e=a.makeGraphData(t.frame);e._iterVal=0,a.graphHistoricData.push(e)}}))},makeGraphData:function(t){t._originalIndex=t.index.slice(),this.sim.model.compartments.forEach((function(e){var a=t.index.findIndex((function(t){return t==e.name}));a>=0&&(t.index[a]="$".concat(e.nameLatex,"$"))})),this.sim.model.observables.forEach((function(e){var a=t.index.findIndex((function(t){return t==e.name}));a>=0&&(t.index[a]="$".concat(e.nameLatex,"$"))}));for(var e=t.columns,a=[],n=0;n<t.data.length;n++)a.push({x:e,y:t.data[n],name:t.index[n],hoverinfo:"x+y",_originalName:t._originalIndex[n]});return a},_getIndexAsString:function(t){return"".concat(this.graphHistoricData[t]._iterVal||t)},dataFetchingDone:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"newPlot",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.$emit("sim-done");for(var a=this.removeHiddenGroups(this.graphHistoricData),n=[],i=0;i<a.length;i++)n.push({method:"animate",label:this._getIndexAsString(i),args:[[this._getIndexAsString(i)],{mode:"next",transition:{duration:400,easing:"linear"},frame:{duration:800,redraw:!0}}]});for(var r=[{active:e,pad:{l:130,t:55},steps:n}],o=[],s=0;s<a.length;s++)o.push({name:this._getIndexAsString(s),data:a[s]});var l=JSON.parse(JSON.stringify(a[e]));mt[t]("plotDiv",{data:l,layout:Object(Q["a"])(Object(Q["a"])({},st),{},{sliders:r}),frames:o,config:this.plotConfig})},updateGraphLayout:function(){var t=this.$refs.plotlyInstance.layout.sliders,e=t[0],a=e.active||0;this.dataFetchingDone("react",a)}}};function Et(){function t(t){return"0".concat(t).slice(0,2)}var e=new Date,a=t(e.getMonth()+1),n=t(e.getDate()),i=t(e.getHours()),r=t(e.getMinutes()),o=t(e.getSeconds());return"".concat(e.getUTCFullYear()).concat(a).concat(n,"-").concat(i).concat(r).concat(o)}function Rt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"csv",a=document.createElement("a");a.setAttribute("href",t),a.setAttribute("download","sim-".concat(Et(),".").concat(e)),document.body.appendChild(a),a.click(),a.remove()}function kt(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a="sampletimes,".concat(t[0].map((function(t){return t.name})).join(","),"\n");e&&(a="iteration,".concat(a)),t.forEach((function(t){var n=t[0].x,i=t.map((function(t){return t.y}));n.forEach((function(n,r){var o="".concat(n,",").concat(i.map((function(t){return t[r]})).join(","),"\n");e&&(o="".concat(t._iterVal,",").concat(o)),a+=o}))}));var n=new Blob([a],{type:"text/csv"});Rt(window.URL.createObjectURL(n))}function It(t){return{displaylogo:!1,modeBarButtons:[[St(t),"zoom2d","zoomIn2d","zoomOut2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian"]],modeBarButtonsToRemove:["pan2d","resetScale2d","sendDataToCloud"]}}var jt=Ot,Mt=(a("1aa9"),Object(m["a"])(jt,X,K,!1,null,"0b48dc58",null)),Dt=Mt.exports,Nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("legend",[t._v("Model Details")]),a("h4",[t._v("Equations")]),a("div",{directives:[{name:"katex",rawName:"v-katex:display",value:t.equations,expression:"equations",arg:"display"}]}),t.currentModel.expressions?a("div",[a("h4",[t._v("Where")]),a("div",{directives:[{name:"katex",rawName:"v-katex:display",value:t.expressions,expression:"expressions",arg:"display"}]}),a("div",{directives:[{name:"katex",rawName:"v-katex:display",value:t.observables,expression:"observables",arg:"display"}]})]):t._e()])},$t=[];a("ac1f"),a("5319");function Pt(){var t=Object(ut["a"])([""," = & ","\\"],[""," = &\\ ","\\\\"]);return Pt=function(){return t},t}function Gt(){var t=Object(ut["a"])([""," = & ","\\"],[""," = &\\ ","\\\\"]);return Gt=function(){return t},t}function At(){var t=Object(ut["a"])([""," = & ","\\"],[""," = &\\ ","\\\\"]);return At=function(){return t},t}function Tt(){var t=Object(ut["a"])(["$1[","pt]"]);return Tt=function(){return t},t}function Lt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return t.replace(/(\\\\)/g,String.raw(Tt(),e))}var Vt={computed:{equations:function(){var t="";return this.currentModel.equations&&(t+="\\begin{aligned}",this.currentModel.equations.forEach((function(e){t+=String.raw(At(),e.nameLatex,e.valueLatex)})),t+="\\end{aligned}"),Lt(t)},expressions:function(){var t="";return this.currentModel.expressions&&(t+="\\begin{aligned}",this.currentModel.expressions.forEach((function(e){t+=String.raw(Gt(),e.nameLatex,e.valueLatex)})),t+="\\end{aligned}"),Lt(t)},observables:function(){var t="";return this.currentModel.observables.length>0&&(t+="\\begin{aligned}",this.currentModel.observables.forEach((function(e){t+=String.raw(Pt(),e.nameLatex,e.valueLatex)})),t+="\\end{aligned}"),Lt(t)}},props:["currentModel"]},Ft=Vt,Ut=Object(m["a"])(Ft,Nt,$t,!1,null,null,null),Ht=Ut.exports,Bt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("details",[a("summary",[t._v("Ro Calculator")]),a("span",[t._v("Enter number of individuals and contact rates:")]),a("div",{staticClass:"section"},[a("label",{attrs:{for:"p"}},[t._v("p:")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.variables.p,expression:"variables.p",modifiers:{number:!0}}],attrs:{name:"p",type:"number"},domProps:{value:t.variables.p},on:{change:t.calculateRo,input:function(e){e.target.composing||t.$set(t.variables,"p",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),a("label",{attrs:{for:"gamma"}},[t._v("Gamma:")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.variables.gamma,expression:"variables.gamma",modifiers:{number:!0}}],attrs:{name:"gamma",type:"number"},domProps:{value:t.variables.gamma},on:{change:t.calculateRo,input:function(e){e.target.composing||t.$set(t.variables,"gamma",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),a("label",{attrs:{for:"s",title:"Number of susceptibles"}},[t._v("S:")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.variables.s,expression:"variables.s",modifiers:{number:!0}}],attrs:{name:"s",type:"number"},domProps:{value:t.variables.s},on:{change:t.calculateRo,input:function(e){e.target.composing||t.$set(t.variables,"s",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),a("div",{staticClass:"section"},[a("table",[a("tbody",[a("tr",[a("th",[t._v("Group")]),a("th",[t._v("Nc")]),t._l(t.numberContagionRates,(function(e){return a("th",{key:e,attrs:{title:"Contact rate "+e}},[t._v(" c"+t._s(e)+" ")])})),a("th",[t._v("c")]),a("th",[t._v("Nc * c")])],2),t._l(t.tableData,(function(e,n){return a("tr",{key:n},[a("td",[t._v(t._s(n+1))]),a("td",[a("input",{staticClass:"normal",attrs:{type:"number"},domProps:{value:e.n},on:{change:function(e){return t.handlePopulationChange(n,e)},paste:function(e){return t.handlePaste(n,-1,e)}}})]),t._l(e.contagionRates,(function(e,i){return a("td",{key:i},[a("input",{staticClass:"small",attrs:{type:"number"},domProps:{value:e},on:{change:function(e){return t.handleContagionChange(n,i,e)},paste:function(e){return t.handlePaste(n,i,e)}}})])})),a("td",[t._v(t._s(e.totalContagion))]),a("td",[t._v(t._s(e.product))])],2)}))],2)])]),a("div",{staticClass:"section"},[a("Results",{attrs:{results:t.results}})],1)])])},Jt=[],qt=(a("cb29"),a("13d5"),a("07ac"),a("1276"),a("498a"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("table",[a("tbody",[a("tr",[a("td",{attrs:{colspan:Object.keys(t.results).length}},[t._v("Results")])]),t._m(0),a("tr",[a("td",[t._v(t._s(t.results.N))]),a("td",[t._v(t._s(t.results.c_mean))]),a("td",[t._v(t._s(t.results.Ro))]),a("td",[t._v(t._s(t.results.Rt))])])])])}),zt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",[t._v("N")]),a("th",[t._v("c (mean)")]),a("th",[t._v("Ro")]),a("th",[t._v("Rt")])])}],Yt={props:["results"]},Wt=Yt,Xt=(a("63f0"),Object(m["a"])(Wt,qt,zt,!1,null,"04979a5e",null)),Kt=Xt.exports,Qt=10,Zt=6;function te(t,e){return new Array(t).fill().map((function(t){return{n:0,contagionRates:new Array(e).fill(0),totalContagion:0,product:0}}))}var ee={components:{Results:Kt},data:function(){return{numberGroups:Qt,numberContagionRates:Zt,tableData:te(Qt,Zt),variables:{p:0,gamma:0,s:0},results:{N:0,c_mean:0,Ro:"-",Rt:"-"}}},created:function(){this.loadValues()},methods:{handlePopulationChange:function(t,e){var a=e.target.value&&parseInt(e.target.value,10),n=this.tableData[t];n.n=a,n.product=n.totalContagion*n.n,this.calculateRo()},handleContagionChange:function(t,e,a){var n=a.target.value&&parseInt(a.target.value,10),i=this.tableData[t];i.contagionRates[e]=n,i.totalContagion=i.contagionRates.reduce((function(t,e){return t+e}),0),i.product=i.totalContagion*i.n,this.calculateRo()},handlePaste:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,a=arguments.length>2?arguments[2]:void 0;a.preventDefault();for(var n=(a.clipboardData||window.clipboardData).getData("text"),i=n.trim().split(/\s/),r=this.tableData[t],o=0;o<i.length;o++){var s=parseInt(i[o],10);-1===e?r.n=s:r.contagionRates[e]=s,e+=1,e>=this.numberContagionRates&&(this.handleContagionChange(t,e-1,{target:{value:r.contagionRates[e-1]}}),e=-1,t+=1,r=this.tableData[t])}this.handleContagionChange(t,e-1,{target:{value:r.contagionRates[e-1]}})},calculateRo:function(){var t=0,e=0;Object.values(this.tableData).forEach((function(a){t+=a.n,e+=a.product})),e/=t,this.results.N=Ct(t,4),this.results.c_mean=Ct(e,4),this.results.Ro=Ct(this.variables.p/this.variables.gamma*e,4),this.results.Rt=Ct(this.results.Ro*this.variables.s/t,4),this.storeValues()},storeValues:function(){var t={variables:this.variables,tableData:this.tableData};"undefined"!==typeof window.localStorage&&window.localStorage.setItem("RoCalculationData",btoa(JSON.stringify(t)))},loadValues:function(){if("undefined"!==typeof window.localStorage){var t=window.localStorage.getItem("RoCalculationData");if(void 0!==t){var e=JSON.parse(atob(t));this.variables=e.variables,this.tableData=e.tableData}this.calculateRo()}}}},ae=ee,ne=(a("7674"),Object(m["a"])(ae,Bt,Jt,!1,null,"4635573c",null)),ie=ne.exports,re=ie;function oe(t){if(null==t.groups){t.groups=[],t.ungrouped={compartments:[],params:[]};var e={},a={};if(t.template&&t.template.groups&&t.template.groups.length){var n,i=Object(o["a"])(t.template.groups);try{for(i.s();!(n=i.n()).done;){var r=n.value,s={name:r.name,visible:r.visible,compartments:[],params:[]};t.groups.push(s);var l,u=Object(o["a"])(r.parameters);try{for(u.s();!(l=u.n()).done;){var c=l.value;a[c]=s}}catch(x){u.e(x)}finally{u.f()}var m,d=Object(o["a"])(r.compartments);try{for(d.s();!(m=d.n()).done;){var p=m.value;e[p]=s}}catch(x){d.e(x)}finally{d.f()}}}catch(x){i.e(x)}finally{i.f()}}var v,f=Object(o["a"])(t.compartments);try{for(f.s();!(v=f.n()).done;){var h=v.value,g=e[h.name];null!=g?g.compartments.push(h):t.ungrouped.compartments.push(h)}}catch(x){f.e(x)}finally{f.f()}var b,_=Object(o["a"])(t.params);try{for(_.s();!(b=_.n()).done;){var y=b.value,S=a[y.name];null!=S?S.params.push(y):t.ungrouped.params.push(y)}}catch(x){_.e(x)}finally{_.f()}}}function se(t){var e=Object.assign({},t);return e.initial_conditions=Object.assign({},t.initial_conditions),e.params=Object.assign({},t.params),e.iterate=Object.assign({},t.iterate),e}var le={beforeMount:function(){this.fetchModels()},data:function(){return{SIM_STATE:rt,simulationState:rt.NONE,errorMsg:null,statusMsg:null,modelList:{},currentModel:null,modelSelected:1,simulation:{step:1,days:365,initial_conditions:{},params:{},iterate:{key:null,start:0,end:1,intervals:10}},currentSimulation:null,simCancel:!1,pendingChanges:!0}},components:{Simulation:Dt,Authors:p,Instructions:_,Editor:W,CurrentModel:Ht,Calculator:re},computed:{modelVariables:function(){return Object.keys(this.simulation.params)}},watch:{simulationModel:function(t){this.pendingChanges=!0,localStorage.setItem(ot,t)},modelSelected:function(t){this.simulationState=rt.NONE;var e=t in this.modelList?this.modelList[t]:{params:[],compartments:[]},a=this.simulation;e.compartments.forEach((function(t){a.initial_conditions[t.name]=t.default})),e.params.forEach((function(t){a.params[t.name]=t.default})),this.simulation=a,this.currentModel=e,oe(this.currentModel)}},methods:{simulate:function(){this.simulationState===rt.INPROGRESS?this.stopSimulation():this.buildSimulation()},fetchModels:function(){var t=this,e=fetch("/api/models/");e.then((function(e){if(e.status>=400&&e.status<600)throw e;e.json().then((function(e){e.models.forEach((function(e){t.modelList[e.id]=e})),t.modelSelected=0}))}))},buildSimulation:function(){var t=this;this.currentSimulation={model:Object.assign({},this.currentModel),simulation:se(this.simulation)},setTimeout((function(){t.pendingChanges=!1}),0)},stopSimulation:function(){this.simCancel=!0},setError:function(t){this.errorMsg="[ERROR]: ".concat(t),this.statusMsg=null},setStatus:function(t){this.errorMsg=null,this.statusMsg=t},handleError:function(t){console.error(t),this.setError(t.message)},handleSubmit:function(t){this.simulationState===rt.INPROGRESS?this.stopSimulation():this.buildSimulation(t)},handleSimStart:function(){this.simulationState=rt.INPROGRESS},handleSimError:function(){this.simulationState=rt.FAILED},handleSimDone:function(){this.simulationState=rt.DONE},handleSimCancel:function(){this.simulationState=rt.CANCELED,this.simCancel=!1}}},ue=le,ce=(a("034f"),Object(m["a"])(ue,i,r,!1,null,null,null)),me=ce.exports,de=a("bfc7");a("be0f");function pe(t){var e=t.$options.title;if(e)return"function"===typeof e?e.call(t):e}var ve={created:function(){var t=pe(this);t&&(document.title=t)}};n["a"].config.productionTip=!1,n["a"].mixin(ve),n["a"].use(de["a"],{globalOptions:{}}),new n["a"]({render:function(t){return t(me)}}).$mount("#app")},"63f0":function(t,e,a){"use strict";var n=a("85f8"),i=a.n(n);i.a},7674:function(t,e,a){"use strict";var n=a("2f84"),i=a.n(n);i.a},"7cbd":function(t,e,a){"use strict";var n=a("0026"),i=a.n(n);i.a},"85ec":function(t,e,a){},"85f8":function(t,e,a){},9391:function(t,e,a){"use strict";var n=a("51ab"),i=a.n(n);i.a},ac8d:function(t,e,a){"use strict";var n=a("b673"),i=a.n(n);i.a},b673:function(t,e,a){},bc62:function(t,e,a){},dd47:function(t,e,a){},ea97:function(t,e,a){"use strict";var n=a("dd47"),i=a.n(n);i.a},ffb2:function(t,e,a){}});
//# sourceMappingURL=app.c81c2134.js.map