(function(t){function e(e){for(var a,o,s=e[0],l=e[1],u=e[2],m=0,d=[];m<s.length;m++)o=s[m],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&d.push(i[o][0]),i[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);c&&c(e);while(d.length)d.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],a=!0,s=1;s<n.length;s++){var l=n[s];0!==i[l]&&(a=!1)}a&&(r.splice(e--,1),t=o(o.s=n[0]))}return t}var a={},i={app:0},r=[];function o(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=a,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(n,a,function(e){return t[e]}.bind(null,a));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="https://cdn.jsdelivr.net/gh/maks500/ecm-FrontendServer@release/dist/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var c=l;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var a=n("85ec"),i=n.n(a);i.a},1:function(t,e){},"11c7":function(t,e,n){"use strict";var a=n("bc62"),i=n.n(a);i.a},3028:function(t,e,n){"use strict";var a=n("4224"),i=n.n(a);i.a},3576:function(t,e,n){"use strict";var a=n("e23b"),i=n.n(a);i.a},4224:function(t,e,n){},"51ab":function(t,e,n){},"536e":function(t,e,n){"use strict";var a=n("e7ae"),i=n.n(a);i.a},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("fieldset",[n("legend",[t._v("Choose a model:")]),n("label",{attrs:{for:"model"}},[t._v("Model: ")]),n("select",{directives:[{name:"model",rawName:"v-model",value:t.modelSelected,expression:"modelSelected"}],staticStyle:{display:"inline-block"},attrs:{name:"model",id:"model"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.modelSelected=e.target.multiple?n:n[0]}}},t._l(t.modelList,(function(e,a){return n("option",{key:a,domProps:{value:a}},[t._v(t._s(e.name))])})),0)]),t.modelSelected&&t.currentModel?n("fieldset",[n("CurrentModel",{attrs:{currentModel:t.currentModel}})],1):t._e(),t.modelSelected&&t.currentModel?n("Editor",{attrs:{model:t.currentModel,simulation:t.simulation}}):t._e(),t.modelSelected?n("fieldset",[n("legend",[t._v("Simulation")]),n("button",{attrs:{disabled:t.simulationState===t.SIM_STATE.INPROGRESS},on:{click:t.simulate}},[t._v(" Simulate ")]),t.currentModel?n("Simulation",{attrs:{sim:t.currentSimulation,"sim-cancel":t.simCancel,"sim-state":t.simulationState},on:{"sim-start":t.handleSimStart,"sim-error":t.handleSimError,"sim-done":t.handleSimDone,"sim-cancel":t.handleSimCancel}}):t._e()],1):t._e(),n("Authors"),t._m(0)],1)},r=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"license"},[t._v(" This software is licensed under GPLv3 and can be obtained at "),n("a",{attrs:{href:"https://github.com/maks500/ecm-FrontendServer"}},[t._v("ecm-FrontendServer")])])}],o=(n("4160"),n("b0c0"),n("b64b"),n("d3b7"),n("159b"),n("b85c")),s=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},l=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("span",{staticClass:"category"},[t._v("Authors:")]),n("p",{staticClass:"names"},[t._v(" Nicolás Morando (*), Mauricio Sanfilippo, Roberto Daniel Rabinovich (*), María de los Ángeles Pando (*). ")]),n("span",{staticClass:"category"},[t._v("Programmers:")]),n("p",{staticClass:"names"},[t._v(" Francisco Herrero, Matías Iturburu, Ariel Torti. ")]),n("span",{staticClass:"category"},[t._v("Acknowledgments:")]),n("p",{staticClass:"names"},[n("a",{attrs:{href:"https://cs.famaf.unc.edu.ar/~nicolasw/"}},[t._v("Nicolás Wolovick (**)")])]),n("div",{staticClass:"references"},[n("span",[n("a",{attrs:{href:"http://www.inbirs.org.ar/"}},[t._v("* Instituto de Investigaciones Biomédicas en Retrovirus y SIDA")])]),n("span",[n("a",{attrs:{href:"https://www.famaf.unc.edu.ar/"}},[t._v("** Facultad de Matemática, Astronomía, Física y Computación")])])])])}],u={},c=u,m=(n("536e"),n("2877")),d=Object(m["a"])(c,s,l,!1,null,"6e1828ce",null),p=d.exports,f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("fieldset",[n("legend",[t._v("Simulation parameters")]),n("details",[n("summary",[t._v("General")]),n("label",{attrs:{for:"days"}},[t._v("Days:")]),n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.simulation.days,expression:"simulation.days",modifiers:{number:!0}}],attrs:{name:"days",type:"number"},domProps:{value:t.simulation.days},on:{input:function(e){e.target.composing||t.$set(t.simulation,"days",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),n("label",{attrs:{for:"step"}},[t._v("Step:")]),n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.simulation.step,expression:"simulation.step",modifiers:{number:!0}}],attrs:{name:"step",type:"number"},domProps:{value:t.simulation.step},on:{input:function(e){e.target.composing||t.$set(t.simulation,"step",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),n("details",[n("summary",[t._v("Initial conditions")]),n("ConditionGroup",{attrs:{group:t.model.ungrouped,simulation:t.simulation}}),t._l(t.model.groups,(function(e){return n("ConditionGroup",{key:e.name,attrs:{group:e,simulation:t.simulation}})}))],2),n("details",[n("summary",[t._v("Params")]),n("ParamGroup",{attrs:{group:t.model.ungrouped,simulation:t.simulation}}),t._l(t.model.groups,(function(e){return n("ParamGroup",{key:e.name,attrs:{group:e,simulation:t.simulation}})}))],2)])},v=[],h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.group.params.length>0?n("div",{staticClass:"group"},[n("span",[t._v(t._s(t.group.name))]),t._l(t.group.params,(function(e){return n("Param",{key:e.name,attrs:{param:e,simulation:t.simulation}})}))],2):t._e()},g=[],b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("strong",[n("span",{directives:[{name:"katex",rawName:"v-katex",value:t.param.nameLatex,expression:"param.nameLatex"}]}),t._v(": ")]),t.param.iterable?n("div",{staticClass:"label-input"},[n("label",{attrs:{for:"param"}},[t._v("with range:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.simulation.iterate.key,expression:"simulation.iterate.key"}],attrs:{type:"radio",id:"param"},domProps:{value:t.param.name,checked:t._q(t.simulation.iterate.key,t.param.name)},on:{click:function(e){return t.paramUncheck(t.param.name)},change:function(e){return t.$set(t.simulation.iterate,"key",t.param.name)}}})]):t._e(),t.simulation.iterate.key==t.param.name?n("div",[n("label",{attrs:{for:t.param+"Start"}},[t._v("Start:")]),n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.simulation.iterate.start,expression:"simulation.iterate.start",modifiers:{number:!0}}],attrs:{id:t.param+"Start",type:"number"},domProps:{value:t.simulation.iterate.start},on:{input:function(e){e.target.composing||t.$set(t.simulation.iterate,"start",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),n("label",{attrs:{for:t.param+"End"}},[t._v("End:")]),n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.simulation.iterate.end,expression:"simulation.iterate.end",modifiers:{number:!0}}],attrs:{id:t.param+"End",type:"number"},domProps:{value:t.simulation.iterate.end},on:{input:function(e){e.target.composing||t.$set(t.simulation.iterate,"end",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),n("label",{attrs:{for:t.param+"Intervals"}},[t._v("Intervals:")]),n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.simulation.iterate.intervals,expression:"simulation.iterate.intervals",modifiers:{number:!0}}],attrs:{id:t.param+"Intervals",type:"number"},domProps:{value:t.simulation.iterate.intervals},on:{input:function(e){e.target.composing||t.$set(t.simulation.iterate,"intervals",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]):n("div",[n("label",{attrs:{for:t.param}},[t._v("Value:")]),n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.simulation.params[t.param.name],expression:"simulation.params[param.name]",modifiers:{number:!0}}],attrs:{type:"number",id:t.param},domProps:{value:t.simulation.params[t.param.name]},on:{input:function(e){e.target.composing||t.$set(t.simulation.params,t.param.name,t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])])},y=[],_={props:["param","simulation"],methods:{paramUncheck:function(t){this.simulation.iterate.key==t&&(this.simulation.iterate.key=null)}}},S=_,x=(n("acb2"),Object(m["a"])(S,b,y,!1,null,"30b280ec",null)),O=x.exports,E={components:{Param:O},props:["group","simulation"]},w=E,M=(n("9391"),Object(m["a"])(w,h,g,!1,null,"38544a90",null)),C=M.exports,j=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.group.compartments.length>0?n("div",{staticClass:"group"},[n("span",[t._v(t._s(t.group.name))]),t._l(t.group.compartments,(function(e){return n("Condition",{key:e.name,attrs:{comp:e,simulation:t.simulation}})}))],2):t._e()},k=[],I=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("label",{attrs:{for:t.comp}},[n("span",{directives:[{name:"katex",rawName:"v-katex",value:t.comp.initLatex,expression:"comp.initLatex"}]}),t._v(": ")]),n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.simulation.initial_conditions[t.comp.name],expression:"simulation.initial_conditions[comp.name]",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:t.simulation.initial_conditions[t.comp.name]},on:{input:function(e){e.target.composing||t.$set(t.simulation.initial_conditions,t.comp.name,t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])},N=[],D={props:["comp","simulation"]},$=D,P=Object(m["a"])($,I,N,!1,null,null,null),A=P.exports,R={components:{Condition:A},props:["group","simulation"]},L=R,T=(n("11c7"),Object(m["a"])(L,j,k,!1,null,"16787ea0",null)),G=T.exports,V={props:["model","simulation"],components:{ParamGroup:C,ConditionGroup:G}},B=V,F=Object(m["a"])(B,f,v,!1,null,null,null),H=F.exports,U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{position:"relative"}},[t.simState===t.SIM_STATE.INPROGRESS?n("div",{staticClass:"progress"},[t._v(" Simulating ")]):t._e(),t.simState===t.SIM_STATE.FAILED?n("div",{staticClass:"errorMsg"},[t._v(" Error: "+t._s(t.errMsg)+" ")]):t._e(),n("div",{class:{hidden:t.isNotDone}},[n("button",{attrs:{id:"downloadCSV"},on:{click:t.downloadCSV}},[t._v("Download CSV")]),n("GroupControls",{attrs:{model:t.sim.model},on:{changeGroupVisibility:t.changeGroupVisibility}}),n("div",{attrs:{id:"imageDiv"}},[t._m(0),n("div",{directives:[{name:"katex",rawName:"v-katex:display",value:t.simulationInfo,expression:"simulationInfo",arg:"display"}],attrs:{id:"simulationInfo"}})])],1),t.simState===t.SIM_STATE.DONE&&t.isMultiple?n("div",{staticClass:"data-html2canvas-ignore",attrs:{id:"plotAnimDiv"}},[n("button",{on:{click:t.handleAnimClick}},[t._v(t._s(t.playing?"| |":"▶"))])]):t._e()])},q=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"plotlyInstance",attrs:{id:"plotDiv"}})}],J=(n("99af"),n("c740"),n("c975"),n("a15b"),n("d81d"),n("fb6a"),n("a9e3"),n("35b3"),n("3ca3"),n("ddb0"),n("2b3d"),n("5530")),z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"group-container"},t._l(this.model.groups,(function(e,a){return n("div",{key:e.name,staticClass:"group"},[n("label",{attrs:{for:e.name}},[t._v(t._s(e.name)+" ")]),n("input",{attrs:{type:"checkbox",id:e.name},domProps:{checked:e.visible},on:{click:function(e){return t.$emit("changeGroupVisibility",a,e.target.checked)}}})])})),0)},Y=[],W={props:["model"]},X=W,K=(n("3576"),Object(m["a"])(X,z,Y,!1,null,"f90b5502",null)),Q=K.exports,Z={DONE:0,INPROGRESS:1,CANCELED:2,FAILED:3,NONE:4},tt="simulationModel",et={yaxis:{fixedrange:!0},xaxis:{title:"Days"}},nt=(n("7db0"),n("4fad"),n("d80f"),n("3835")),at=n("8785"),it=n("2909"),rt=n("030a");function ot(){var t=Object(at["a"])(["end{array} end{array}"],["\\end{array} \\end{array}"]);return ot=function(){return t},t}function st(){var t=Object(at["a"])([""," & "," \\"],[""," & "," \\\\"]);return st=function(){return t},t}function lt(){var t=Object(at["a"])(["\begin{array}{cc} \\"],["\\begin{array}{cc} \\\\"]);return lt=function(){return t},t}function ut(){var t=Object(at["a"])(["end{array}\n  &"],["\\end{array}\n  &"]);return ut=function(){return t},t}function ct(){var t=Object(at["a"])([""," & "," \\"],[""," & "," \\\\"]);return ct=function(){return t},t}function mt(){var t=Object(at["a"])(["\begin{array}{cc}"],["\\begin{array}{cc}"]);return mt=function(){return t},t}function dt(){var t=Object(at["a"])(["\text{Model: "," - Days: ","} \\\n\begin{array}{c}"],["\\text{Model: "," - Days: ","} \\\\\n\\begin{array}{c}"]);return dt=function(){return t},t}function pt(t){if(null!=t.layout.sliders&&t.layout.sliders.length){var e=t.layout.sliders[0],n=e.active||0;return e.steps[n].label}return null}function ft(t,e){function n(t){var e=r.find((function(e){return e.name===t}));return null==e?null:"".concat(e.nameLatex)}var a=t.model,i=t.simulation,r=[].concat(Object(it["a"])(a.compartments),Object(it["a"])(a.expressions),Object(it["a"])(a.observables),Object(it["a"])(a.params)),o=Object.assign({},i.params);i.iterate&&i.iterate.key&&(o[i.iterate.key]=pt(e));var s=String.raw(dt(),a.name,i.days);s+=String.raw(mt());for(var l=0,u=Object.entries(o||{});l<u.length;l++){var c=Object(nt["a"])(u[l],2),m=c[0],d=c[1],p=n(m);null!=p&&(s+=String.raw(ct(),p,d))}s+=String.raw(ut()),s+=String.raw(lt());for(var f=0,v=Object.entries(i.initial_conditions||{});f<v.length;f++){var h=Object(nt["a"])(v[f],2),g=h[0],b=h[1],y=n(g);null!=y&&(s+=String.raw(st(),y,b))}return s+=String.raw(ot()),s}function vt(t){return{name:"toImage",title:"Download plot as a png",icon:rt["Icons"].camera,click:t}}var ht=n("c0e9"),gt=n.n(ht),bt={components:{GroupControls:Q},props:["sim","simCancel","simState"],data:function(){return{SIM_STATE:Z,graphHistoricData:[],stats:{totalSteps:null,currentStep:null},errMsg:"",abortSignal:null,playing:!1,simulationInfo:""}},mounted:function(){this.plotConfig=xt(this.saveToImage)},computed:{isMultiple:function(){return this.sim&&null!=this.sim.simulation.iterate.key},isNotDone:function(){return this.simState!==Z.DONE}},watch:{sim:function(t){null!=t&&this.simulate()},simCancel:function(t){t&&(this.abortSignal.abort(),this.$emit("sim-cancel"))}},methods:{downloadCSV:function(){St(this.graphHistoricData,this.isMultiple)},handleError:function(t){var e=this;t.ABORT_ERR&&t.code===t.ABORT_ERR?this.$emit("sim-cancel"):(t.json().then((function(t){e.errMsg=t.error})),this.$emit("sim-error"))},stop:function(){},saveToImage:function(){var t=this;this.simulationInfo=ft(this.sim,this.$refs.plotlyInstance);var e=document.getElementById("imageDiv"),n=document.getElementById("simulationInfo");this.$nextTick((function(){gt()(e,{scrollX:-window.scrollX,scrollY:-window.scrollY,height:e.offsetHeight+n.offsetHeight,onclone:function(t){var e=t.getElementById("simulationInfo");e.style.position="initial",e.style.display="block";var n=t.getElementsByClassName("slider-container");if(0!==n.length){var a=n[0].getBoundingClientRect().height;n[0].style.display="none",e.style.marginTop="-".concat(a,"px")}}}).then((function(e){var n=e.toDataURL("image/png",1);t.simulationInfo="",_t(n,"png")}))}))},_play:function(){var t=this;rt["animate"]("plotDiv",null,{mode:"immediate",fromcurrent:!0,transition:{duration:300},frame:{duration:500,redraw:!1}}).then((function(){return t.playing=!1}))},_pause:function(){rt["animate"]("plotDiv",[null],{mode:"immediate",fromcurrent:!0,transition:{duration:0},frame:{duration:0,redraw:!1}})},changeGroupVisibility:function(t,e){var n=this.sim.model.groups[t];null!=n&&(n.visible=e),this.updateGraphLayout()},removeHiddenGroups:function(t){var e=[];this.sim.model.groups.map((function(t){if(!t.visible){var n,a=Object(o["a"])(t.compartments);try{for(a.s();!(n=a.n()).done;){var i=n.value;e.push(i.name)}}catch(u){a.e(u)}finally{a.f()}var r,s=Object(o["a"])(t.params);try{for(s.s();!(r=s.n()).done;){var l=r.value;e.push(l.name)}}catch(u){s.e(u)}finally{s.f()}}}));for(var n=[],a=0;a<t.length;a++){n.push([]);var i,r=Object(o["a"])(t[a]);try{for(r.s();!(i=r.n()).done;){var s=i.value;-1==e.indexOf(s._originalName)&&n[a].push(s)}}catch(l){r.e(l)}finally{r.f()}}return n},handleAnimClick:function(){this.playing?this._pause():this._play(),this.playing=!this.playing},simulate:function(){var t=this;if(null!=this.sim){this.$emit("sim-start"),this.graphHistoricData=[],this.simulationInfo="";var e=JSON.parse(JSON.stringify(this.sim.simulation));if(this.isMultiple){if(0===this.sim.simulation.iterate.intervals)return}else delete e.iterate;this._simulate(e,this.sim.model.id).then((function(){return t.dataFetchingDone()})).catch((function(e){return t.handleError(e)}))}},_simulate:function(t,e){var n=this,a=new AbortController,i=a.signal;this.abortSignal=a;var r=fetch("/simulate/".concat(e),{headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},method:"POST",body:JSON.stringify(t),signal:i});return r.then((function(t){if(t.status>=400&&t.status<600)throw t;return t.json()})).then((function(t){if("multiple"===t.type)t.frames.forEach((function(e,a){var i=n.makeGraphData(e);i._iterVal=n._preciseRound(t.param.values[a],2),n.graphHistoricData.push(i)}));else{var e=n.makeGraphData(t.frame);e._iterVal=0,n.graphHistoricData.push(e)}}))},makeGraphData:function(t){t._originalIndex=t.index.slice(),this.sim.model.compartments.forEach((function(e){var n=t.index.findIndex((function(t){return t==e.name}));n>=0&&(t.index[n]="$".concat(e.nameLatex,"$"))})),this.sim.model.observables.forEach((function(e){var n=t.index.findIndex((function(t){return t==e.name}));n>=0&&(t.index[n]="$".concat(e.nameLatex,"$"))}));for(var e=t.columns,n=[],a=0;a<t.data.length;a++)n.push({x:e,y:t.data[a],name:t.index[a],hoverinfo:"x+y",_originalName:t._originalIndex[a]});return n},_preciseRound:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7;return Math.round((t+Number.EPSILON)*Math.pow(10,e))/Math.pow(10,e)},_getIndexAsString:function(t){return"".concat(this.graphHistoricData[t]._iterVal||t)},dataFetchingDone:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"newPlot",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.$emit("sim-done");for(var n=this.removeHiddenGroups(this.graphHistoricData),a=[],i=0;i<n.length;i++)a.push({method:"animate",label:this._getIndexAsString(i),args:[[this._getIndexAsString(i)],{mode:"next",transition:{duration:400,easing:"linear"},frame:{duration:800,redraw:!0}}]});for(var r=[{active:e,pad:{l:130,t:55},steps:a}],o=[],s=0;s<n.length;s++)o.push({name:this._getIndexAsString(s),data:n[s]});var l=JSON.parse(JSON.stringify(n[e]));rt[t]("plotDiv",{data:l,layout:Object(J["a"])(Object(J["a"])({},et),{},{sliders:r}),frames:o,config:this.plotConfig})},updateGraphLayout:function(){var t=this.$refs.plotlyInstance.layout.sliders,e=t[0],n=e.active||0;this.dataFetchingDone("react",n)}}};function yt(){function t(t){return"0".concat(t).slice(0,2)}var e=new Date,n=t(e.getMonth()+1),a=t(e.getDate()),i=t(e.getHours()),r=t(e.getMinutes()),o=t(e.getSeconds());return"".concat(e.getUTCFullYear()).concat(n).concat(a,"-").concat(i).concat(r).concat(o)}function _t(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"csv",n=document.createElement("a");n.setAttribute("href",t),n.setAttribute("download","sim-".concat(yt(),".").concat(e)),document.body.appendChild(n),n.click(),n.remove()}function St(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="sampletimes,".concat(t[0].map((function(t){return t.name})).join(","),"\n");e&&(n="iteration,".concat(n)),t.forEach((function(t){var a=t[0].x,i=t.map((function(t){return t.y}));a.forEach((function(a,r){var o="".concat(a,",").concat(i.map((function(t){return t[r]})).join(","),"\n");e&&(o="".concat(t._iterVal,",").concat(o)),n+=o}))}));var a=new Blob([n],{type:"text/csv"});_t(window.URL.createObjectURL(a))}function xt(t){return{displaylogo:!1,modeBarButtons:[[vt(t),"zoom2d","zoomIn2d","zoomOut2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian"]],modeBarButtonsToRemove:["pan2d","resetScale2d","sendDataToCloud"]}}var Ot=bt,Et=(n("3028"),Object(m["a"])(Ot,U,q,!1,null,"c9c9190e",null)),wt=Et.exports,Mt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("legend",[t._v("Model Details")]),n("h4",[t._v("Equations")]),n("div",{directives:[{name:"katex",rawName:"v-katex:display",value:t.equations,expression:"equations",arg:"display"}]}),t.currentModel.expressions?n("div",[n("h4",[t._v("Where")]),n("div",{directives:[{name:"katex",rawName:"v-katex:display",value:t.expressions,expression:"expressions",arg:"display"}]}),n("div",{directives:[{name:"katex",rawName:"v-katex:display",value:t.observables,expression:"observables",arg:"display"}]})]):t._e()])},Ct=[],jt={computed:{equations:function(){var t="";return this.currentModel.equations&&(t+="\\begin{aligned}",this.currentModel.equations.forEach((function(e){t+="".concat(e.nameLatex," = & ").concat(e.valueLatex,"\\\\")})),t+="\\end{aligned}"),t},expressions:function(){var t="";return this.currentModel.expressions&&(t+="\\begin{aligned}",this.currentModel.expressions.forEach((function(e){t+="".concat(e.nameLatex," = & ").concat(e.valueLatex,"\\\\")})),t+="\\end{aligned}"),t},observables:function(){var t="";return this.currentModel.observables.length>0&&(t+="\\begin{aligned}",this.currentModel.observables.forEach((function(e){t+="".concat(e.nameLatex," = & ").concat(e.valueLatex,"\\\\")})),t+="\\end{aligned}"),t}},props:["currentModel"]},kt=jt,It=Object(m["a"])(kt,Mt,Ct,!1,null,null,null),Nt=It.exports;function Dt(t){if(null==t.groups){t.groups=[],t.ungrouped={compartments:[],params:[]};var e={},n={};if(t.template&&t.template.groups&&t.template.groups.length){var a,i=Object(o["a"])(t.template.groups);try{for(i.s();!(a=i.n()).done;){var r=a.value,s={name:r.name,visible:r.visible,compartments:[],params:[]};t.groups.push(s);var l,u=Object(o["a"])(r.parameters);try{for(u.s();!(l=u.n()).done;){var c=l.value;n[c]=s}}catch(x){u.e(x)}finally{u.f()}var m,d=Object(o["a"])(r.compartments);try{for(d.s();!(m=d.n()).done;){var p=m.value;e[p]=s}}catch(x){d.e(x)}finally{d.f()}}}catch(x){i.e(x)}finally{i.f()}}var f,v=Object(o["a"])(t.compartments);try{for(v.s();!(f=v.n()).done;){var h=f.value,g=e[h.name];null!=g?g.compartments.push(h):t.ungrouped.compartments.push(h)}}catch(x){v.e(x)}finally{v.f()}var b,y=Object(o["a"])(t.params);try{for(y.s();!(b=y.n()).done;){var _=b.value,S=n[_.name];null!=S?S.params.push(_):t.ungrouped.params.push(_)}}catch(x){y.e(x)}finally{y.f()}}}function $t(t){var e=Object.assign({},t);return e.initial_conditions=Object.assign({},t.initial_conditions),e.params=Object.assign({},t.params),e.iterate=Object.assign({},t.iterate),e}var Pt={beforeMount:function(){this.fetchModels()},data:function(){return{SIM_STATE:Z,simulationState:Z.NONE,errorMsg:null,statusMsg:null,modelList:{},currentModel:null,modelSelected:1,simulation:{step:1,days:365,initial_conditions:{},params:{},iterate:{key:null,start:0,end:1,intervals:10}},currentSimulation:null,simCancel:!1,pendingChanges:!0}},components:{Simulation:wt,Authors:p,Editor:H,CurrentModel:Nt},computed:{modelVariables:function(){return Object.keys(this.simulation.params)}},watch:{simulationModel:function(t){this.pendingChanges=!0,localStorage.setItem(tt,t)},modelSelected:function(t){this.simulationState=Z.NONE;var e=t in this.modelList?this.modelList[t]:{params:[],compartments:[]},n=this.simulation;e.compartments.forEach((function(t){n.initial_conditions[t.name]=t.default})),e.params.forEach((function(t){n.params[t.name]=t.default})),this.simulation=n,this.currentModel=e,Dt(this.currentModel)}},methods:{simulate:function(){this.simulationState===Z.INPROGRESS?this.stopSimulation():this.buildSimulation()},fetchModels:function(){var t=this,e=fetch("/api/models/");e.then((function(e){if(e.status>=400&&e.status<600)throw e;e.json().then((function(e){e.models.forEach((function(e){t.modelList[e.id]=e})),t.modelSelected=0}))}))},buildSimulation:function(){var t=this;this.currentSimulation={model:Object.assign({},this.currentModel),simulation:$t(this.simulation)},setTimeout((function(){t.pendingChanges=!1}),0)},stopSimulation:function(){this.simCancel=!0},setError:function(t){this.errorMsg="[ERROR]: ".concat(t),this.statusMsg=null},setStatus:function(t){this.errorMsg=null,this.statusMsg=t},handleError:function(t){console.error(t),this.setError(t.message)},handleSubmit:function(t){this.simulationState===Z.INPROGRESS?this.stopSimulation():this.buildSimulation(t)},handleSimStart:function(){this.simulationState=Z.INPROGRESS},handleSimError:function(){this.simulationState=Z.FAILED},handleSimDone:function(){this.simulationState=Z.DONE},handleSimCancel:function(){this.simulationState=Z.CANCELED,this.simCancel=!1}}},At=Pt,Rt=(n("034f"),Object(m["a"])(At,i,r,!1,null,null,null)),Lt=Rt.exports,Tt=n("bfc7");n("be0f");function Gt(t){var e=t.$options.title;if(e)return"function"===typeof e?e.call(t):e}var Vt={created:function(){var t=Gt(this);t&&(document.title=t)}};a["a"].config.productionTip=!1,a["a"].mixin(Vt),a["a"].use(Tt["a"],{globalOptions:{}}),new a["a"]({render:function(t){return t(Lt)}}).$mount("#app")},"85ec":function(t,e,n){},9391:function(t,e,n){"use strict";var a=n("51ab"),i=n.n(a);i.a},acb2:function(t,e,n){"use strict";var a=n("f20e"),i=n.n(a);i.a},bc62:function(t,e,n){},e23b:function(t,e,n){},e7ae:function(t,e,n){},f20e:function(t,e,n){}});
//# sourceMappingURL=app.0916b6d3.js.map